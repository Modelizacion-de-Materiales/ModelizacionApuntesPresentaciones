\subsubsection{Apertura y cierre de archivos}

\mode<article>

En todos los lenguajes de programación se utiliza algún comando
para abrir los archivos, por ejemplo \textbf{fopen} en matlab.
Este comando suele aceptar un argumento para indicar el
nombre de archivo a abrir, que puede ser una variable 
de tipo string o cadena de caracteres. Otro argumento
que se le da a \textbf{fopen} es el permiso con el 
que el archivo debe ser abierto, por ejemplo
de escritura generalmente \textbf{w}, solo lectura \textbf{r}
, o para agregar contenido al final o \emph{append} \textbf{a}. 
En la  \autoref{FigIOAbrirArchivos} se esquematiza
la utilización de estos comandos. 

Es necesario notar que el comando \textbf{open} devuelve
una variable de salida que en el ejemplo se asigna 
en la variable \textbf{fid}. 
La importancia de la misma radica en que a partir
de la asignación \textbf{fid} se convierte en 
un \emph{indicador del archivo}, una especie de puntero
a la primer línea disponible del archivo. En caso
de haberlo abierto con permisos de escritura, 
el puntero indica la primer línea del 
archivo que debe escribirse. Por el contrario
al abrir el archivo con permisos de lectura
el puntero apunta a la primer
línea que puede leerse. El concepto quedará 
claro enseguida. 

\begin{figure}
  \includeslide[width=\textwidth]{FrameIOAbrirArchivos}
  \caption{Comandos básicos para la apertura de un archivo\label{FigIOAbrirArchivos}}
\end{figure}

\mode*

\begin{frame}<presentation>[label=FrameIOAbrirArchivos]
  \frametitle{Apertura y cierre de archivos}

  \begin{columns}[T]
    \column{0.5\textwidth}
    \hfill Abrir archivo existente para lectura:
    \column{0.5\textwidth}
    \begin{codeblock}
      \verbatiminput{./CODEXAMPLES/open_file.m}
    \end{codeblock}
  \end{columns}

  \begin{columns}[T]
    \column{0.5\textwidth}
    \hfill Abrir archivo \emph{inexistente} para lectura:
    \column{0.5\textwidth}
    \begin{codeblock}
      \verbatiminput{./CODEXAMPLES/open_file_noex.m}
    \end{codeblock}
  \end{columns}

  \begin{columns}[T]
    \column{0.5\textwidth}
    \hfill Abrir otro archivo  para \emph{escritura}:
    \column{0.5\textwidth}
    \begin{codeblock}
      \verbatiminput{./CODEXAMPLES/open_otherfile.m}
    \end{codeblock}
  \end{columns}

\end{frame}

\mode<all>

\subsubsection{Escritura Secuencial}

\mode<article>

Una estrategia para registar los datos en un archivo es 
escribir en el mísmo lína por línea, o en forma \emph{secuencial}.
Una vez abierto el archivo con permisos para escritura, 
se escriben los datos con el comando \textbf{fprintf}. 
El mismo acepta como argumentos el indicador de archivo, 
un \emph{string} de formato y la lista de variables 
que se guardan. El mecanismo se ilustra en la 
\autoref{FigIOEscribir}.

El string de formato suele usar caracteres especiales para indicar
la posición y el formato (punto flotante con precision dada, numeros enteros,
texto, etc) en la que la lista de variables debe 
imprimirse. No daremos detalle aquí, pero puede
buscar en los manuales el uso de los \emph{format 
identifiers, indicadores de formato}, ya que serán 
de suma utilidad. la correspondencia entre el 
indicador de formato y la variable que se escribe
es posicional, y en general para esribir un número 
real se usa el indicador \textbf{\%f} con algun 
indicador extra para la precisión. 
Observe la necesidad de imprimir los cambios de línea
o \emph{retornos de carro} para indicar los fines de línea. 

Los archivos siempre deben ser cerrados al terminar la operación 
de escritura o lectura. 

\begin{figure}
  \includeslide[width=\textwidth]{FrameIOEscribir}
  \caption{Algunos ejemplos de escritura secuencial con formato\label{FigIOEscribir}}
\end{figure}

\mode*

\begin{frame}<presentation>[label=FrameIOEscribir]
\frametitle{Escritura línea por línea}

\begin{columns}[T]
\column{0.6\textwidth}
\hfill \small \texttt{Escribir con formato de punto flotante.} 
\tikz\node  (A) at (-0.3,0) {};
\par

  \vspace{0.5cm}
\hfill \small \texttt{Escribir con retorno de carro.}
\tikz\node  (B) at (-0.3,0) {};
\par

  \vspace{0.5cm}
\hfill \small \texttt{Escribir con formato de punto flotante.}
\tikz\node  (C) at (-0.3,0) {};
\par

  \column{0.4\textwidth}
  \tikz[overlay]\node   (X) at (-0.1,-1.5) {};
  \tikz[overlay]\node   (Y) at (-0.1,-2.0) {};
  \tikz[overlay]\node   (Z) at (-0.1,-2.8) {};
\begin{codeblock}
  \verbatiminput{./CODEXAMPLES/frprintfs.m}
\end{codeblock}

\end{columns}


\begin{columns}[T]
\column{0.5\textwidth}
 \hfill \small Resultado\par
\column{0.5\textwidth}
\begin{codeblock}
\verbatiminput{./CODEXAMPLES/datasimple.dat}
\end{codeblock}
\end{columns}

\begin{tikzpicture}[overlay]
  \draw[->,>=latex,draw,thick] (A) -- (X) ;
  \draw[->,>=latex,draw,thick] (B) -- (Y) ;
  \draw[->,>=latex,draw,thick] (C) -- (Z) ;
\end{tikzpicture}

\end{frame}

\mode<all>

